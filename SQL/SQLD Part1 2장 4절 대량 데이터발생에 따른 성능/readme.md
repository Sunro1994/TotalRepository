# SQLD [과목1] 2장 4절 대량 데이터발생에 따른 성능

작성일시: 2023년 8월 27일 오후 8:08
종류: SQL
복습: No

## 🟰 대량 데이터 발생에 따른 테이블 분할

- [ ]  테이블 분할 설계를 통한 성능 저하의 예방
    1. `수평 분할` : 컬럼 단위로 분할하여 I/O(Input/Output) 경감
    2. `수직 분할` : 로우 단위로 분할하여 I/O 경감

![https://postfiles.pstatic.net/20151204_70/liberty264_1449229700788wsuE5_JPEG/1.jpg?type=w3](https://postfiles.pstatic.net/20151204_70/liberty264_1449229700788wsuE5_JPEG/1.jpg?type=w3)

- [ ]  성능저하의 원인
    1. 하나의 테이블에 데이터 대량집중 : 데이터가 한 테이블에 대량으로 집중될 때 테이블 구조가 너무 커져서 효율성이 떨어진다.
    2. 하나의 테이블에 여러개의 컬럼 존재 : 디스크의 점유량이 높아지고 데이터를 읽는 I/O량이 많아져서 성능이 저하된다.
    3. 대량의 데이터가 처리되는 테이블의 경우 : SQL문장에서 데이터를 처리하기 위한 I/O양이 증가한다. 인덱스를 적절히 구성하면 이를 줄일 수 있다.
    4. 대량의 데이터가 하나의 테이블에 존재 할 떄 : 인덱스를 생성할 때 인덱스의 크기가 커지게 되고 그렇게 되면 인덱스를 찾아가는 단계가 깊어지게 되어 조회의 성능에도 영향을 미치게 된다.
    5. 컬럼이 많아지는 경우 : 물리적인 디스크에 여러 블록의 데이터가 저장되게 된다.
- [ ]  로우 체이닝(Row Chaining) : 로우 길이가 너무 길어서 블록 한에 데이터가 모두 저장되지 않고 두 개 이상의 블록에 걸쳐 하나의 로우가 저장
- [ ]  로우 마이그레이션(Row Migration) : 데이터 블록에서 수정이 발생하면 데이터를 해당 데이터 블록에 저장하지 못하고 다른 블록의 빈 공간을 찾아 저장

## 🟰 한 테이블에 많은 수의 컬럼을 가지고 있는 경우

![https://postfiles.pstatic.net/20151204_53/liberty264_1449229902159xxMEU_JPEG/2.jpg?type=w3](https://postfiles.pstatic.net/20151204_53/liberty264_1449229902159xxMEU_JPEG/2.jpg?type=w3)

✅테이블을 분리

![https://postfiles.pstatic.net/20151204_218/liberty264_1449229871822eu4Iy_JPEG/3.jpg?type=w3](https://postfiles.pstatic.net/20151204_218/liberty264_1449229871822eu4Iy_JPEG/3.jpg?type=w3)

## 🟰대량 데이터 저장 및 처리로 인해 성능이 저하되는 경우

- [ ]  해결책
    
    `**파티셔닝**`
    
    `**PK에 의한 테이블 분할**`
    
    보통 데이터량이 천만건을 넘어서면 아무리 서버사양이 좋고, 인덱스를 잘 생성해 준다 하더라도 SQL문장의 성능이 나오지 않는다.
    
    논리적으로는 하나의 테이블로 보이지만 물리적으로는 여러개의 테이블 스페이스에 쪼개어 저장될 수 있는 구조의 파티셔닝을 적용해야 한다.
    
- [ ]  파티셔닝
    
    `**Range Partition**`
    
    1. 가장 많이 사용된다.
    2. 대상 테이블이 **날짜 또는 숫자값**으로 분리가 가능하고, **영역별로 트랜잭션이 분리된 대상**
    3. 데이터 보관주기에 따라 테이블에 데이터를 쉽게 지우는 것이 가능
    
    ![https://postfiles.pstatic.net/20151204_169/liberty264_1449230102026ovNYu_JPEG/4.jpg?type=w3](https://postfiles.pstatic.net/20151204_169/liberty264_1449230102026ovNYu_JPEG/4.jpg?type=w3)
    
    `**List Partition**`
    
    대용량 데이터를 특정값에 따라 분리/저장 가능
    
    쉽게 삭제되는 기능은 없다.
    
    ![https://postfiles.pstatic.net/20151204_289/liberty264_1449230127945mu1Kt_JPEG/5.jpg?type=w3](https://postfiles.pstatic.net/20151204_289/liberty264_1449230127945mu1Kt_JPEG/5.jpg?type=w3)
    
    Hash Partition
    
    저장된 해쉬 조건에 따라 해쉬 알고리즘이 적용되어 테이블이 분리된다.
    
    데이터의 확인이 어렵고 삭제 불가능
    

## 🟰 테이블에 대한 수평분할/ 수직분할의 절차

- [ ]  4가지 원칙
    1. 데이터 모델링을 완성한다.
    2. 데이터 베이스 용량선정을 한다.(컬럼 수에 따라 고려)
    3. 대량 데이터가 처리되는 테이블에 대해서 트랜잭션 처리 패턴을 분석한다.
    4. 컬럼 단위로 집중화된 처리가 발생하는지, 열 단위로 집중화된 처리가 발생하는지 분석하여 집중화된 단위로 테이블을 분리하는 것을 검토
    
    컬럼수가 많다 > 1:1로 분리 가능한지 검토
    
    컬럼수는 적으나 데이터 량이 많다면 > 파티셔닝 고려