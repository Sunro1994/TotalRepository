# JPA SHOP Project

# Index

1. 도메인 분석 설계
    - 요구사항 분석
    - 도메인 모델과 테이블 설계
    - 엔티티 클래스 개발
2. 애플리케이션 구현 준비
    - 구현 요구사항
    - 애플리케이션 아키텍처
3. 회원 도메인 개발
    - 회원 리포지토리 개발
    - 회원 서비스 개발
    - 회원 기능 테스트
4. 상품 도메인 개발
    - 상품 엔티티 개발(비즈니스 로직 추가)
    - 상품 리포지토리 개발
    - 상품 서비스 개발
5. 주문 도메인 개발
    - 주문, 주문상품 엔티티 개발
    - 주문 리포지토리 개발
    - 주문 서비스 개발
    - 주문 기능 테스트
    - 주문 검색 기능 개발
6. 웸 계층 개발
    - 홈 화면과 레이아웃
    - 회원 등록
    - 회원 목록 조회
    - 상품 등록
    - 상품 목록
    - 상품 수정
    - 변경 감지와 병합
    - 상품 주문

## 도메인 분석 설계

### 요구사항 분석

- 회원 기능
    - 회원 등록
    - 회원 조회
    - 회원 수정
    - 회원 탈퇴
- 상품 기능
    - 상품 등록
    - 상품 수정
    - 상품 조회
- 주문 기능
    - 상품 주문
    - 주문 내역 조회
    - 주문 취소
- 기타 요구사항
    - 상품은 재고관리가 필요하다
    - 상품의 종류는 도서,음반,영화가 있다.
    - 상품을 카테고리로 구분할 수 있다.
    - 상품 주문시 배송 정보를 입력할 수 있다.

## 도메인 모델과 테이블 설계
![Untitled](https://github.com/Sunro1994/TotalRepository/assets/132982907/4e5bdfde-cb94-4847-b87c-4b5e069e99c3)



- 회원, 주문, 상품의 관계
    - 회원은 여러 상품을 주문 할 수 있다.
    - 한 번 주문할 때 여러 상품을 선택할 수 있으므로 주문과 상품은 다대다 관계이다.
    - 주문상품이라는 엔티티를 추가해서 다대다 관계를 일대다 관계로 풀어냈다.
- 상품 분류
    - 상품은 도서, 음반, 영화로 구분되는 상품이란느 공통 속성을 사용하므로 상속 구조로 표현했다.

## 엔티티 클래스 개발

- 회원 엔티티 분석
    
![Untitled 1](https://github.com/Sunro1994/TotalRepository/assets/132982907/8c5f1e2f-9df8-4a4c-a179-6a8ee5b179ea)

- 회원
    - 이름과 주소(임베디드 타입), 주문 리스트를 가진다.
- 주문
    - 주문 상품은 일대다 관계
    - 주문은 회원과 배송 정보, 주문  날짜, 주문 상태(Enum타입)을 갖고 있다.
    - 주문 상태는 주문, 취소를 표현할 수 있다.
- 주문상품
    - 주문한 상품 정보와 주문 금액, 주문 수량 정보를 가지고 있다.
- 상품
    - 이름, 가격, 재고수량을 갖고 있다.
    - 주문 시 재고수량이 줄어든다.
    - 상품의 종류로는 도서, 음반, 영화가 있으며 속성이 조금씩 다르다.
- 배송
    - 주문과 일대일 관계이다.
- 카테고리
    - 상품과 다대다 관계
    - parent,child로 부모,자식 카테고리를 연결한다.
- 주소
    - 값 타입
    - 호원과 배송에서 사용한다.

### 회원 테이블 분석

![Untitled](https://github.com/Sunro1994/TotalRepository/assets/132982907/15b324c7-6c14-4dbc-a605-8793c6aa4854)


- MEMBER
    - 회원 엔티티의 Address 타입 정보가 회원 테이블에 그대로 들어갔다.
- ITEM
    - 앨범, 도서, 영화 타입을 통합해서 싱글 테이블로 생성했다. DTYPE으로 컬럼을 구분한다.
- ORDERS
    - 예약어 이슈로 ORDER을 사용하지 못하였다.

### 연관관계 분석

- 회원과 주문
    - 일대일, 다대일 양방향 관계
    - 연관관계의 주인은 외래 키가 있는 주문을 연관관계로 정함
- 주문상품과 주문
    - 다대일 양방향 관계
    - 주문상품에 외래키가 있으므로 주문상품을 주인으로 정함
- 주문과 배송
    - 일대일 양방향 관계
    - oRDER를 주인으로 정함
- 카테고리와 상품
    - 다대다 관계
    - 중간 테이블을 생성해서 일대다, 다대일 관계를 지정

## 애플리케이션 구현 준비

### 구현 요구사항

![Untitled 3](https://github.com/Sunro1994/TotalRepository/assets/132982907/3afc0f62-5b32-428f-a352-4a91503ab29a)

- 회원 기능
    - 회원 등록
    - 회원 조회
    - 회원 수정
    - 회원 삭제
    - 로그인
    - 권한 관리
- 상품 기능
    - 상품 등록
    - 상품 수정
    - 상품 조회
    - 상품 삭제
- 주문 기능
    - 상품 주문
    - 주문 내역 조회
    - 주문 취소
    - 배송 정보
- 카테고리 기능
    - 카테고리 등록
    - 카테고리 수정
    - 카테고리 조회
    - 카테고리 삭제

### 애플리케이션 아키텍처

![Untitled 4](https://github.com/Sunro1994/TotalRepository/assets/132982907/f75d5939-7e1d-46cb-aed3-84ebbbf6ad63)

- 계층형 구조 사용
    - Controller,Web : 웹 계층
    - Service : 비즈니스 계층
    - repository : JPA를 직접 사용하느 계층, 엔티티 매니저 사용
    - domain : 엔티티가 모여 있는 계층, 모든 계층에서 사용
- 패키지 구조
    - jpabook, jpashop
        - domain
        - exception
        - repository
        - service
        - web
- 개발 순서
    - 서비스
    - 리포지토리
    - 테스트 케이스 작성후 검증
    - 웹 계층 적용

## 회원 도메인 개발